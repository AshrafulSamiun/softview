<template>
    <fieldset>
        
        
        <div class="row align-self-stretch">
            <div class="col-md-9 col-sm-6 col-xs-9">
                <div class="form-card">

                    <div class="d-flex gap-3 p-3 ">
                    
                        <div class="text-center custom-btn">
                            <button class="btn btn-primary " >Gross Profit (Loss)</button>
                            <div class="details">+200</div>
                        </div>
                        <div class="text-center custom-btn">
                            <button class="btn btn-primary" >Net Profit (Loss)</button>
                    
                            <div class="details">+100</div>
                        </div>


                        <div class="text-center custom-btn">
                            <button class="btn btn-primary" >Net Cash In/ Out    
                            </button>
                    
                            <div class="details">Details</div>
                        </div>

                        <div class="text-center custom-btn">
                             <button class="btn btn-primary" >Invoice Term</button>  
                    
                            <div class="details">500</div>
                        </div>
                        

                        <div class="text-center custom-btn">
                            <button class="btn btn-primary" >AP Vs AR</button>
                    
                            <div class="details">Details</div>
                        </div>
                        <div class="text-center custom-btn">
                            <button class="btn btn-primary" >Pass Due AP </button>
                    
                            <div class="details">30</div>
                        </div>

                        <div class="text-center custom-btn">
                            <button class="btn btn-primary fs-6" >Pass Due AR</button>
                    
                            <div class="details">45</div>
                        </div>
                    </div>
                </div>


                <div class="form-card mt-3">
                    <div class="form-folder" >
                        <h3 class="bg-dark text-warning"><i class="fa-solid fa-triangle-exclamation"></i>&nbsp;&nbsp;Alerts</h3>

                        <div class="d-flex gap-3 p-3 ">
                    
                            <div class="text-center custom-btn" style="width:16%">
                                <button class="btn btn-success "  style="background-color: #64813D;width:100%">Normal</button>
                                <div class="details">+200</div>
                            </div>
                            <div class="text-center custom-btn" style="width:16%">
                                <button class="btn bg-secondary text-white"  style="width:100%">Low</button>
                        
                                <div class="details">+100</div>
                            </div>


                            <div class="text-center custom-btn" style="width:16%">
                                <button class="btn btn-warning" style="width:100%">Midium   
                                </button>
                        
                                <div class="details">Details</div>
                            </div>

                            <div class="text-center custom-btn" style="width:16%">
                                 <button class="btn btn-danger"  style="width:100%">High</button>  
                        
                                <div class="details">500</div>
                            </div>
                            

                            <div class="text-center custom-btn" style="width:16%">
                                <button class="btn btn-danger"  style="background-color:#63339C; border:1px solid #63339C; width:100%">Urgent</button>
                                <div class="details">Details</div>
                            </div>
                            <div class="text-center custom-btn" style="width:16%">
                                <button class="btn btn-dark" style="width:100%" >Immediate Action</button>
                        
                                <div class="details">30</div>
                            </div>

                            
                        </div>
                    </div>
                </div> 

                <div class="form-card mt-3">
                    <div class="form-folder" >
                        <table class="table table-bordered">
                            <tbody>

                                <tr>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                
                                </tr>
                                <tr>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                
                                </tr>
                                <tr>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                
                                </tr>
                                <tr>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                
                                </tr>
                                <tr>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                
                                </tr>
                                <tr>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                
                                </tr>
                                <tr>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                
                                </tr>
                                <tr>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                
                                </tr>
                                <tr>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                
                                </tr>
                                <tr>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                
                                </tr>
                                <tr>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                
                                </tr>
                                <tr>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                
                                </tr>
                                <tr>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                
                                </tr>
                            </tbody>
                            
                        </table>
                    </div>
                </div>


            </div>
            <div class="col-md-3 col-sm-6 col-xs-3">
                <div class="form-card custom-btn">
                    <button class="btn btn-primary btn-block" > <strong>Quick Link</strong></button>
                    <button class="btn btn-light btn-block" > <strong>Quick Link</strong></button>
                    <button class="btn btn-outline-secondary btn-block" > <strong>Calendar Event</strong></button>
                    <button class="btn btn-outline-secondary btn-block" > <strong>Trail Balance </strong></button>
                    <button class="btn btn-outline-secondary btn-block" > <strong>Balance Sheet</strong></button>
                    <button class="btn btn-outline-secondary btn-block" > <strong>Income Statement</strong></button>
                    <button class="btn btn-outline-secondary btn-block" > <strong>Accounts Payable list </strong></button>
                    <button class="btn btn-outline-secondary btn-block" > <strong>AP Ageing Report</strong></button>
                    <button class="btn btn-outline-secondary btn-block" > <strong>Accounts Receivable List</strong></button>

                    <button class="btn btn-outline-secondary btn-block" > <strong>Past Due AP Bills</strong></button>

                    <button class="btn btn-outline-secondary btn-block" > <strong>Past Dues AR Invoices</strong></button>
                    <button class="btn btn-outline-secondary btn-block" > <strong>Inventory Items</strong></button>
                    <button class="btn btn-outline-secondary btn-block" > <strong>Shipping & Receiving </strong></button>
                    <button class="btn btn-outline-secondary btn-block" > <strong>Budget & Actual </strong></button>
                   
                </div>

                <div class="form-card custom-btn mt-3">
                    <button class="btn btn-primary btn-block" > <strong>Quick Link</strong></button>
                    <button class="btn btn-light btn-block" > <strong>Quick Link</strong></button>
                    <button class="btn btn-outline-secondary btn-block" > <strong>Sales  Cash</strong></button>
                    <button class="btn btn-outline-secondary btn-block" > <strong>Purchase Cash </strong></button>
                    <button class="btn btn-outline-secondary btn-block" > <strong>Bill Payment </strong></button>
                    <button class="btn btn-outline-secondary btn-block" > <strong>Bill Payment </strong></button>
                    <button class="btn btn-outline-secondary btn-block" > <strong>Receipt </strong></button>
                    <button class="btn btn-outline-secondary btn-block" > <strong>Expense report </strong></button>
                
                   
                </div>
            </div>
        </div>
        <div class="row mt-4">
            <div class="col-md-4 clo-sm-6 col-xs-12">
                <div class="form-card">

                    <div>
                        <h2> PI Chart</h2>
                         <Responsive class="w-full">
                            <template #main="{ width }">
                              <Chart
                                direction="circular"
                                :size="{ width, height: 400 }"
                                :data="data"
                                :margin="{
                                  left: Math.round((width - 360)/2),
                                  top: 20,
                                  right: 0,
                                  bottom: 20
                                }"
                                :axis="axis"
                                :config="{ controlHover: false }"
                                >
                                <template #layers>
                                  <Pie
                                    :dataKeys="['name', 'pl']"
                                    :pie-style="{ innerRadius: 100, padAngle: 0.05 }" />
                                </template>
                                <template #widgets>
                                  <Tooltip
                                    :config="{
                                      name: { },
                                      avg: { hide: true},
                                      pl: { label: 'value' },
                                      inc: { hide: true }
                                    }"
                                    hideLine
                                  />
                                </template>
                              </Chart>
                            </template>
                          </Responsive>
                    </div>
                </div>
            </div>
           
            <div class="col-md-4 clo-sm-6 col-xs-12">
                <div class="form-card">

                    <div>
                        <h2> Line Chart</h2>
                        <Chart
                            :size="{ width: 400, height: 350 }"
                            :data="data"
                            :margin="margin"
                            :direction="direction">

                            <template #layers>
                              <Grid strokeDasharray="2,2" />
                              <Line :dataKeys="['name', 'pl']" />
                            </template>

                          </Chart>
                    </div>
                </div>
            </div>
               

            <div class="col-md-4 clo-sm-6 col-xs-12">
                <div class="form-card">
                    <template>
                        <div class="month-calendar">
                            <div class="month-header">
                                <button type="button" class="btn btn-primary" @click="prevMonth">Previous Month</button>
                                <h2>{{ monthNames[form.current_month] }} {{ form.current_year }}</h2>
                                <button type="button" class="btn btn-primary" @click="nextMonth">Next Month</button>
                            </div>
                            
                            <div class="days-header">
                                <span v-for="day in dayNames" :key="day">{{ day }}</span>
                            </div>
                            
                            <div class="days-grid">
                                <div v-for="sinday in getDaysInMonth(form.current_month)" class="day"
                                    @click="editCalendar(sinday.id)"
                                    :class="{ 'is-today': isToday(sinday.day, form.current_month), 'is-selected': isSelected(sinday.day, form.current_month), 'has-event': sinday.event }"
                                    :title="sinday.subject">
                                    {{ sinday.day }}
                                    <span v-if="sinday.event" class="tooltip">{{ sinday.subject }}</span>
                                </div>
                            </div>

                            <div class="holidays">
                                <h5>Holidays</h5>
                            </div>
                        </div>
                    </template>

                </div>

            </div>
        </div>
    
        
    </fieldset>
   
  <!-- https://vue3charts.org/docs/getting-started -->
</template>

<style>
    .custom-btn .btn-outline-secondary {
        border: 1px solid #B9B9B966;
        color: #414141b2;

    }
    .custom-btn .btn-outline-secondary:hover {
        color: #212529;
        background-color: #eee;
    }

    .month-calendar {
        width: 100%;
        max-width: 400px;
        margin: auto;
        text-align: center;
    }
    .days-header {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        font-weight: bold;
    }
    .days-grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
    }
    .day {
        padding: 10px;
        border: 1px solid #ddd;
        cursor: pointer;
    }
    .is-today {
        background-color: lightblue;
    }
    .is-selected {
        background-color: lightgreen;
    }
    .has-event {
        background-color: orange;
    }
    .tooltip {
        display: block;
        font-size: 12px;
        color: red;
    }
</style>
<script>
    import { defineComponent, ref } from 'vue'
    import { Chart, Grid, Line, Responsive, Pie, Tooltip } from 'vue3-charts'
    import Vue3Datatable from "@bhplugin/vue3-datatable";
    import "@bhplugin/vue3-datatable/dist/style.css";
    import DatePicker from 'vue3-datepicker';
    

   

    export default {
        name: 'list-product-categories',
        components: {
            DatePicker,
            Vue3Datatable,
            Chart,
            Grid,
            Line,
            Responsive,
            Pie,
            Tooltip
        },
        data() {
            return {
                editmode: false,
                show_company: true,
                filter: '',
                form: new Form({
                    company_avaibale: true,
                    company_id: "",
                    company_type: '',
                    account_no: '',
                    legal_name: '',
                    currency_id: '',
                    company_arr: [],
                    current_year: new Date().getFullYear(),
                    current_month: new Date().getMonth()
                }),
                columns: ref([
                    {title: 'SL', field: 'sl', align: 'center'},
                    {title: 'Company', field: 'company_name'},
                    {title: 'Last Modified Date and Time', field: 'last_modified_date'},
                    {title: 'Last Modification By', field: 'last_modified_by'},
                ]),
                page: 1,
                per_page: 15,
                expanded: null,

                monthNames: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
                dayNames: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
                selectedDate: null,
                calendar_list: {}, // Your event data

                data : [
                      { name: 'Jan', pl: 1000, avg: 500, inc: 300 },
                      { name: 'Feb', pl: 2000, avg: 900, inc: 400 },
                      { name: 'Apr', pl: 400, avg: 400, inc: 500 },
                      { name: 'Mar', pl: 3100, avg: 1300, inc: 700 },
                      { name: 'May', pl: 200, avg: 100, inc: 200 },
                      { name: 'Jun', pl: 600, avg: 400, inc: 300 },
                      { name: 'Jul', pl: 500, avg: 90, inc: 100 }
                    ],
                plByMonth : [
                        { name: 'Jan', pl: 1000, avg: 500, inc: 300 },
                        { name: 'Feb', pl: 2000, avg: 900, inc: 400 },
                        { name: 'Apr', pl: 400, avg: 400, inc: 500 },
                        { name: 'Mar', pl: 3100, avg: 1300, inc: 700 },
                        { name: 'May', pl: 200, avg: 100, inc: 200 },
                        { name: 'Jun', pl: 600, avg: 400, inc: 300 },
                        { name: 'Jul', pl: 500, avg: 90, inc: 100 }
                    ],
                direction : ref('horizontal'),
                margin : ref({
                      left: 0,
                      top: 20,
                      right: 20,
                      bottom: 0
                    }),
                axis: ref({
                      primary: {
                        type: 'band'
                      },
                      secondary: {
                        domain: ['dataMin', 'dataMax + 100'],
                        type: 'linear',
                        ticks: 8
                      }
                    }),
                attributes: [
                    {
                        key: 'red-dates',
                        dates: ['2025-01-09', '2025-01-10', '2025-01-11'],
                        highlight: { color: 'red', fillMode: 'solid' },
                        dot: { color: 'red', size: '6px' },
                        bar: { color: 'red' },
                        popover: { 
                        label: 'Important Event', 
                        visibility: 'hover' 
                        },
                        customData: {
                        event: 'Meeting',
                        description: 'Project deadline discussions'
                        },
                        order: 1
                    },
                    {
                        key: 'blue-date',
                        dates: ['2025-01-12'],
                        highlight: { color: 'blue', fillMode: 'solid' },
                        dot: { color: 'blue', size: '6px' },
                        popover: { 
                        label: 'Birthday Celebration', 
                        visibility: 'hover' 
                        },
                        customData: {
                        event: 'Birthday',
                        description: 'John’s Birthday Party'
                        },
                        order: 2
                    },
                    {
                        key: 'green-dates',
                        dates: ['2025-01-25', '2025-01-26'],
                        highlight: { color: 'green', fillMode: 'solid' },
                        dot: { color: 'green', size: '6px' },
                        bar: { color: 'green' },
                        popover: { 
                        label: 'Holiday', 
                        visibility: 'hover' 
                        },
                        customData: {
                        event: 'Holiday',
                        description: 'Weekend Holiday'
                        },
                        order: 3
                    },
                    {
                        key: 'small-dots',
                        dates: ['2025-01-03', '2025-01-17', '2025-01-24', '2025-01-31'],
                        dot: { color: 'orange', size: '5px' },
                        popover: { 
                        label: 'Reminder', 
                        visibility: 'hover' 
                        },
                        customData: {
                        event: 'Reminder',
                        description: 'General Reminder'
                        },
                        order: 4
                    },
                    {
                        key: 'purple-dot',
                        dates: ['2025-01-23'],
                        dot: { color: 'purple', size: '5px' },
                        popover: { 
                        label: 'Meeting', 
                        visibility: 'hover' 
                        },
                        customData: {
                        event: 'Client Meeting',
                        description: 'Meeting with client at 2 PM'
                        },
                        order: 5
                    }
                ],
            }
        },
        created: function () {
            this.user_menu_name = this.$route.name;
            this.fetchDashboard();
        },
        methods: {

            getDaysInMonth(month) {
                const days = [];
                const date = new Date(this.form.current_year, month, 1);
                const firstDay = date.getDay();
                const lastDate = new Date(this.form.current_year, month + 1, 0).getDate();

                // Fill in blank days for the first row
                for (let i = 0; i < firstDay; i++) {
                    days.push({ id: '', day: '', event: false, subject: '' });
                }

                // Fill in actual days
                for (let day = 1; day <= lastDate; day++) {
                    if (this.calendar_list[month]?.[day]) {
                        days.push({ ...this.calendar_list[month][day], day, event: true });
                    } else {
                        days.push({ id: '', day, event: false, subject: '' });
                    }
                }

                return days;
            },
            prevMonth() {
                if (this.form.current_month === 0) {
                    this.form.current_month = 11;
                    this.form.current_year--;
                } else {
                    this.form.current_month--;
                }
                this.fetchCalendar();
            },
            nextMonth() {
                if (this.form.current_month === 11) {
                    this.form.current_month = 0;
                    this.form.current_year++;
                } else {
                    this.form.current_month++;
                }
                this.fetchCalendar();
            },
            isToday(day, month) {
                const today = new Date();
                return today.getDate() === day && today.getMonth() === month && today.getFullYear() === this.form.current_year;
            },
            isSelected(day, month) {
                return this.selectedDate &&
                    this.selectedDate.getDate() === day &&
                    this.selectedDate.getMonth() === month &&
                    this.selectedDate.getFullYear() === this.form.current_year;
            },
            editCalendar(id) {
                console.log("Edit event with ID:", id);
            },
       
            change_company(row) {
                this.form.company_avaibale  =true,
                this.form.company_id    =row.company_id,
                this.form.company_name    =row.company_name,
                this.form.last_modified_by  =row.last_modified_by,
                this.form.last_modified_date=row.last_modified_date,
                this.form.post('/OpenFiles').then(({data}) => {
                    window.open('/Dashboard', '_self');
                })
            },
            fetchDashboard() {
                /*let uri = '/userDashboards';
                window.axios.get(uri).then((response) => {
                    
                });*/
            },
        }
    }
</script>